INSERT OVERWRITE LOCAL DIRECTORY '/home/azureuser/sample/data/' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED AS TEXTFILE SELECT customer.CUSTOMER_ID,FIRST_NAME,MIDDLE_NAME,LAST_NAME,DOB,GENDER,NATIONALITY,IDENTIFIER_TYPE,IDENTIFIER,MARITAL_STATUS,OCCUPATION,AVG_FAMILY_SIZE,INCOME_LEVEL,DATE_ONBOARDED,ADDRESS_ID,ADDRESS_TYPE,ADDRESS1,ADDRESS2,ADDRESS3,CITY,STATE,COUNTRY,ZIPCODE,PHONE,EMAIL,FAX,product.PRODUCT_ID,PRODUCT_NAME,PRODUCT_TYPE,PRODUCT_DESCRIPTION,ISSUE_DATE,VALID_TILL_DATE,ACCOUNT_STATUS,CREDIT_CARD_LIMIT,INTEREST_RATE,TENURE,SERVICE_CHARGES,FD_PRINCIPAL_AMOUNT,LOAN_COLLATERAL_VALUE,LOAN_AMOUNT,TRANSACTION_ID,MERCHANT_NAME,TRANSACTION_DESCRIPTION,TRANSACTION_AMOUNT,TYPE_DEPOSIT_WITHDRAWAL,TRANSACTION_DATE,CHANNEL,floor(DATEDIFF(CURRENT_DATE,from_unixtime(unix_timestamp(DOB,'dd-mm-yyyy'),'yyyy-MM-dd'))/365) AGE FROM datalake.customer LEFT OUTER JOIN datalake.address ON (customer.CUSTOMER_ID = address.CUSTOMER_ID) LEFT OUTER JOIN datalake.transactions ON (customer.CUSTOMER_ID = transactions.CUSTOMER_ID) LEFT OUTER JOIN datalake.product ON (transactions.PRODUCT_ID = product.PRODUCT_ID) WHERE product.PRODUCT_TYPE='credit card'